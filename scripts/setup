set -e


cd "$(dirname "$0")/.."

# Create .venv if not present
# Create .venv if not present
python3 -m venv .venv

# Install requirements if not already installed
./.venv/bin/pip install -r requirements.txt && touch .venv/.requirements_installed


# Create config dir if not present
mkdir -p "${PWD}/config"
# hass --config "${PWD}/config" --script ensure_config

# Create symlink to custom_components in config directory if it doesn't exist
ln -sf "${PWD}/custom_components" "${PWD}/config/custom_components"